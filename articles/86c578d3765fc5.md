---
title: "C# 9.0ã®ç¯„å›²ãƒ‘ã‚¿ãƒ¼ãƒ³ã®switchã¯ã‚ã‚Šã¨è³¢ãã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã•ã‚Œã‚‹"
emoji: "ğŸ™†"
type: "tech"
topics:
  - "dotnet"
  - "csharp"
published: true
published_at: "2021-05-05 17:06"
---

## ç¯„å›²ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ä½¿ã£ãŸswitchå¼

C# 9.0 ã§ switchå¼ã«æ¯”è¼ƒæ¼”ç®—ã‚’æŒ‡å®šã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚

```csharp:å…ƒã®ã‚³ãƒ¼ãƒ‰
public class C
{
    public int Expr(int num) => num switch
    {
            <=0 => -1,
            < 10 => 0,
            < 20 => 1,
            < 30 => 2,
            < 40 => 3,
            < 50 => 4,
            < 60 => 5,
            _ => -1,
    };
}
```

ä¸Šè¨˜ã®ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«çµæœ(ã®ILã‚’C#ã«ãƒ‡ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ãŸã‚‚ã®)ã¯ã“ã¡ã‚‰ã€‚

```csharp:ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«çµæœ
public class C
{
    public int Expr(int num)
    {
        if (num < 30)
        {
            if (num < 10)
            {
                if (num <= 0)
                {
                    return -1;
                }
                return 0;
            }
            if (num < 20)
            {
                return 1;
            }
            return 2;
        }
        if (num < 50)
        {
            if (num < 40)
            {
                return 3;
            }
            return 4;
        }
        if (num < 60)
        {
            return 5;
        }
        return -1;
    }
}
```

ãªã‚“ã¨äºŒåˆ†æ¢ç´¢ã«ãªã£ã¦ã„ã¾ã™ã€‚

ã“ã®ãã‚‰ã„ãªã‚‰ã°ifæ–‡ã‚’åˆ—æŒ™ã—ã¦ã‚‚å¤§å·®ãªã„ã‹ã¨ã¯æ€ã„ã¾ã™ãŒã€äºŒåˆ†æ¢ç´¢ã«ãªã‚‹ã“ã¨ã§ ifæ–‡ãŒå®Ÿè¡Œã•ã‚Œã‚‹å›æ•°ãŒ $log_2(ã‚±ãƒ¼ã‚¹æ•°)$ å›ç¨‹åº¦ã«ãªã‚Šã¾ã™ã€‚ãƒ‡ãƒ¡ãƒªãƒƒãƒˆãªã—ã§é«˜é€ŸåŒ–ãŒæœŸå¾…ã§ãã‚‹ã®ã§ã€ç¯„å›²ã‚’åˆ—æŒ™ã™ã‚‹ã‚ˆã†ãªç®‡æ‰€ã§ã¯ç©æ¥µçš„ã«switchå¼ã§æ›¸ã„ã¦ã—ã¾ã†ã®ãŒè‰¯ã•ãã†ã§ã™ã€‚

ã¡ãªã¿ã«ã€switchæ–‡ã§ã‚‚ã‚¸ãƒ£ãƒ³ãƒ—ãƒ†ãƒ¼ãƒ–ãƒ«ã«ã§ããªã„ã‚ˆã†ãªå ´åˆã¯äºŒåˆ†æ¢ç´¢ã«å¤‰æ›ã•ã‚Œã‚‹ã‚ˆã†ã§ã™ã€‚
http://engineering.grani.jp/entry/2017/02/20/175816

### è¿½è¨˜

ã€Œãƒ‡ãƒ¡ãƒªãƒƒãƒˆãªã—ã§ã€ã¨æ›¸ãã¾ã—ãŸãŒã€ã€Œæ®†ã©ã®å ´åˆã¯ `0 <= num && num < 10` ã§ã‚ã‚‹ã€ã¨ã„ã†ã‚ˆã†ã«ãƒãƒƒãƒã™ã‚‹é »åº¦ãŒéå¸¸ã«é«˜ã„ã‚‚ã®ãŒã‚ã‚‹ãªã‚‰ãƒãƒƒãƒã™ã‚‹é »åº¦ãŒé«˜ã„é †ã«ifæ–‡ã‚’ç¾…åˆ—ã™ã‚‹ã»ã†ãŒäºŒåˆ†æ¢ç´¢ã‚ˆã‚Šé«˜é€Ÿãã†ã§ã™ã€‚ã€‚

## orã‚’ä½¿ã†å ´åˆ

`or` ã‚‚ä½¿ã£ã¦ã¿ã¾ã™ã€‚

```csharp:å…ƒã®ã‚³ãƒ¼ãƒ‰
public class C
{
    public int Expr(int num) => num switch
    {
            <=0 => -1,
            < 10 or > 600 => 0,
            < 20 or > 500 => 1,
            < 30 or > 400 => 2,
            < 40 or > 300 => 3,
            < 50 or > 200 => 4,
            < 60 or > 100 => 5,
            _ => -1,
    };
}
```

ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«çµæœã¯ã“ã¡ã‚‰ã€‚

```csharp:ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«çµæœ
public class C
{
    public int Expr(int num)
    {
        if (num > 100)
        {
            if (num > 300)
            {
                if (num > 500)
                {
                    if (num > 600)
                    {
                        goto IL_0061;
                    }
                    goto IL_0065;
                }
                if (num > 400)
                {
                    goto IL_0069;
                }
                goto IL_006d;
            }
            if (num > 200)
            {
                goto IL_0071;
            }
        }
        else
        {
            if (num < 30)
            {
                if (num < 10)
                {
                    if (num > 0)
                    {
                        goto IL_0061;
                    }
                    return -1;
                }
                if (num < 20)
                {
                    goto IL_0065;
                }
                goto IL_0069;
            }
            if (num < 50)
            {
                if (num < 40)
                {
                    goto IL_006d;
                }
                goto IL_0071;
            }
            if (num >= 60)
            {
                return -1;
            }
        }
        return 5;
        IL_0065:
        return 1;
        IL_0061:
        return 0;
        IL_0071:
        return 4;
        IL_0069:
        return 2;
        IL_006d:
        return 3;
    }
}
```

`goto`ã§ã‚¹ãƒ‘ã‚²ãƒƒãƒ†ã‚£æ°—å‘³ã«ãªã£ã¦ã„ã¾ã™ãŒã€ã“ã‚Œã‚‚äºŒåˆ†æ¢ç´¢ã«ãªã£ã¦ã„ã¾ã™ã€‚

## çµè«–

ç¯„å›²ãƒã‚§ãƒƒã‚¯ã‚’åˆ—æŒ™ã™ã‚‹ã¨ãã¯ `switch`å¼ã ã¨åŠ¹ç‡çš„ï¼